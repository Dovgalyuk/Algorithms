cmake_minimum_required(VERSION 3.15)
add_executable(lab2cpp_app main.cpp)
if(MSVC)
    target_compile_options(lab2cpp_app PRIVATE /W3)
endif()
target_include_directories(lab2cpp_app PRIVATE ../LibraryCPP)
target_link_libraries(lab2cpp_app LibraryCPP)
add_test(NAME lab2_test1 COMMAND $<TARGET_FILE:lab2cpp_app> ${CMAKE_CURRENT_SOURCE_DIR}/test1.txt)
set_tests_properties(lab2_test1 PROPERTIES PASS_REGULAR_EXPRESSION "5 12 34")
add_test(NAME lab2_test2 COMMAND $<TARGET_FILE:lab2cpp_app> ${CMAKE_CURRENT_SOURCE_DIR}/test2.txt)
set_tests_properties(lab2_test2 PROPERTIES PASS_REGULAR_EXPRESSION "1 2 3 4 5")

add_test(NAME lab2_test_big_array COMMAND $<TARGET_FILE:lab2cpp_app> ${CMAKE_CURRENT_SOURCE_DIR}/big_input.txt)
set_tests_properties(lab2_test_big_array PROPERTIES TIMEOUT 30)
set(EXPECTED_OUTPUT "")
foreach(i RANGE 1 10000)
    if(i EQUAL 1)
        set(EXPECTED_OUTPUT "${i}")
    else()
        set(EXPECTED_OUTPUT "${EXPECTED_OUTPUT} ${i}")
    endif()
endforeach()
set_tests_properties(lab2_test_big_array PROPERTIES PASS_REGULAR_EXPRESSION "${EXPECTED_OUTPUT}")