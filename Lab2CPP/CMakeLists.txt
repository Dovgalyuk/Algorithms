cmake_minimum_required(VERSION 3.15)
add_executable(lab2cpp_app main.cpp)
if(MSVC)
    target_compile_options(lab2cpp_app PRIVATE /W3)
endif()
target_include_directories(lab2cpp_app PRIVATE ../LibraryCPP)
target_link_libraries(lab2cpp_app LibraryCPP)
add_test(NAME lab2_test1 COMMAND $<TARGET_FILE:lab2cpp_app> ${CMAKE_CURRENT_SOURCE_DIR}/test1.txt)
set_tests_properties(lab2_test1 PROPERTIES PASS_REGULAR_EXPRESSION "5 12 34")
add_test(NAME lab2_test2 COMMAND $<TARGET_FILE:lab2cpp_app> ${CMAKE_CURRENT_SOURCE_DIR}/test2.txt)
set_tests_properties(lab2_test2 PROPERTIES PASS_REGULAR_EXPRESSION "1 2 3 4 5")

file(WRITE ${CMAKE_CURRENT_BINARY_DIR}/big_input.txt "")
foreach(i RANGE 1 100000)
file(APPEND ${CMAKE_CURRENT_BINARY_DIR}/big_input.txt "${i} ")
endforeach()
add_test(NAME lab2_test_big_array COMMAND $<TARGET_FILE:lab2cpp_app> ${CMAKE_CURRENT_BINARY_DIR}/big_input.txt)
set_tests_properties(lab2_test_big_array PROPERTIES PASS_REGULAR_EXPRESSION "." TIMEOUT 30)