set(LAB3_TEST_DIR ${CMAKE_CURRENT_SOURCE_DIR}/)
set(LAB3_BUILD_TEST_DIR ${CMAKE_CURRENT_BINARY_DIR}/)

set(TEST_NUMBERS 1 2 3 4 5 6)

foreach(N ${TEST_NUMBERS})
	set(INPUT_FILE    ${LAB3_TEST_DIR}/test${N}.txt)
	set(EXPECTED_FILE ${LAB3_TEST_DIR}/test${N}-expected.txt)
	set(OUTPUT_FILE   ${LAB3_BUILD_TEST_DIR}/output${N}.txt)

	add_test(NAME Lab3Test${N}
			COMMAND ${CMAKE_COMMAND}
			-DPROGRAM=$<TARGET_FILE:Lab3>
			-DINPUT=${INPUT_FILE}
			-DOUTPUT=${OUTPUT_FILE}
			-DEXPECTED=${EXPECTED_FILE}
			-P ${LAB3_TEST_DIR}/run_test.cmake
	)

	set_tests_properties(Lab3Test${N} PROPERTIES
			WORKING_DIRECTORY $<TARGET_FILE_DIR:Lab3>
	)
endforeach()